
@{
    ViewBag.Title = "Chart";
}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<style>

    body {
        background-image: url("/Images/doctor_bg.jpg") !important;
        background-repeat: no-repeat !important;
        background-size: cover !important;
        margin-top: 3%;
    }
    .navbar-inverse {
        background-color: #2e4b42 !important;
    }

        .navbar-inverse .navbar-nav > li > a {
            color: white;
        }

        .navbar-inverse .navbar-brand {
            color: white;
            font-size: 25px;
        }
</style>

<h2>Chart</h2>
<canvas id="myChart" style="width:100%;"></canvas>
<script>

    $.ajax({
        url: "/Chart/GetChartData",
        type: "Get",
        data: [],
        dataType: 'json',
        success: function (result) {

            var xValues = ["JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"];

            const DATA_COUNT = 12;
            const NUMBER_CFG = { count: DATA_COUNT, min: 0, max: 100 };

            var not_visitedList = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            var visitedList = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            var cancelList = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

            result.map(function (val, i) {

                if (val.Pstatus == "Cancelled") {
                    cancelList[val.MonthVal - 1] = val.CountVal;
                }

                if (val.Pstatus == "Visited") {
                    visitedList[val.MonthVal - 1] = val.CountVal;
                }

                if (val.Pstatus == "Not_Visited") {
                    not_visitedList[val.MonthVal - 1] = val.CountVal;
                }
            });
         

            const labels = ["JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"];//Utils.months({ count: 7 });
            const data = {
                labels: labels,
                datasets: [
                    {
                        label: 'Visited',
                        data: visitedList,
                        borderColor: "green",
                        backgroundColor: "green",
                    },
                    {
                        label: 'Cancelled',
                        data: cancelList,
                        borderColor: "red",
                        backgroundColor: "red",
                    },
                    {
                        label: 'Not Visited',
                        data: not_visitedList,
                        borderColor: "brown",
                        backgroundColor: "brown",
                    }
                ]
            };

            const config = {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Monthly Data'
                        }
                    }
                },
            };
            new Chart("myChart", config);

        },
        error: function (err) {
            console.log(err);
        }
    });

    

</script>